/*
	 Test statistics versus time distribution.

	 Weiran, Nov.4, 2018.
*/

void Draw()
{
	/* Asimov data for 0.35eV spectrum. */
	int entry1[70] = {10778747,10197808,9638329,9099853,8581935,8084140,7606041,7147220,6707269,6285781,5882356,5496593,5128097,4776470,4441318,4122245,3818855,3530753,3257543,2998831,2754221,2523318,2305725,2101049,1908892,1728861,1560559,1403592,1257563,1122077,996738,881152,774922,677653,588950,508417,435659,370279,311882,260073,214457,174636,140217,110803,85998,65407,48635,35285,24962,17270,307176,213158,156718,127662,17842,17359,17287,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280};
//	int entry1[70] = {42438504,40406293,38502895,36157342,34308941,32573542,30712390,28869351,27301439,25837686,24045810,22642379,21329936,19930263,18554149,17390467,16308782,14996068,13976489,13028078,12024177,11046948,10227392,9470159,8562134,7865254,7221916,6548112,5901697,5366128,4875693,4297922,3862557,3465295,3055948,2672247,2360492,2079162,1757250,1522182,1311965,1101465,912350,764203,634248,493839,397820,315580,238355,175668,130888,94541,61323,43071,29708,20220,15781,14085,13515,13515,13515,13515,13515,13515,13515,13515,13515,13515,13515,13515};

	/* Asimov data for 0eV spectrum. */
	int entry2[70] = {10778902,10198042,9638638,9100234,8582385,8084653,7606616,7147853,6707956,6286518,5883138,5497417,5128959,4777367,4442245,4123198,3819830,3531748,3258554,2999854,2755253,2524355,2306766,2102089,1909929,1729892,1561581,1404602,1258558,1123056,997698,882091,775837,678543,589812,509250,436460,371047,312616,260770,215116,175257,140797,111341,86494,65859,49042,35647,25277,17539,312929,217664,159968,129664,17984,17397,17292,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280,17280};
//	int entry2[70] = {42443590,40411427,38508071,36162562,34314189,32578812,30717678,28874648,27306739,25842985,24051098,22647651,21335189,19935489,18559340,17395621,16313898,15001126,13981493,13033028,12029061,11051757,10232131,9474828,8566706,7869741,7226318,6552416,5905894,5370227,4879695,4301795,3866319,3468949,3059477,2675644,2363769,2082322,1760255,1525057,1314713,1104070,914803,766519,636432,495852,399688,317308,239927,177075,132149,95661,62260,43856,30345,20693,16080,14246,13566,13515,13515,13515,13515,13515,13515,13515,13515,13515,13515,13515};

	double error[70];
	for(int i=0; i<70; i++) {
		error[i] = sqrt(entry1[i])/entry1[i];
	}

	/* Calculate scale factor. */
	int count1 = 0, count2 = 0;
	for(int i=0; i<70; i++) {
		count1 += entry1[i];
		count2 += entry2[i];
	}
	double scale = double(count1)/count2;

	/* Error. */
	int npt = 70;
	double xCenter[npt], yCenter[npt];
	double xError[npt], yError[npt];

	TGraph* graph = new TGraph(70);
	for(int i=0; i<70; i++) {
		double x = -30 + (i+0.5)/2.;
		double y = double(entry1[i])/entry2[i] /scale;
		xCenter[i] = x;
		yCenter[i] = y;
		xError[i] = 0.25;
		yError[i] = error[i] * y;
//		if(i==51) yError[i] = y * sqrt(entry1[i]*70./3./365. * 250.)/(entry1[i]*70./3/365 * 250);
		graph->SetPoint(i, x, y);
	}

	TGraphAsymmErrors* err = new TGraphAsymmErrors(npt, xCenter, yCenter, xError, xError, yError, yError);
	err->SetMarkerColor(kBlack);
	err->SetMarkerStyle(8);
	err->SetMarkerSize(0.5);

	graph->SetTitle("Spectrum distortion (0.35eV neutrino)");
	graph->GetXaxis()->SetTitle("qU-E_{0} [eV]");
	graph->GetYaxis()->SetTitle("Relative difference");
	graph->GetYaxis()->SetTitleSize(0.045);
	graph->SetLineColor(kBlue);
	graph->GetYaxis()->SetRangeUser(0.97, 1.01);
	graph->GetXaxis()->SetRangeUser(-30,5);
	graph->GetXaxis()->SetTitleSize(0.045);
	graph->Draw("alp");
	err->Draw("Psame");
}



